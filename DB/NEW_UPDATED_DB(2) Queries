create database FYP_PROJECT_3
use FYP_PROJECT_3


CREATE TABLE USERS (
    ID  INT IDENTITY(1,1) PRIMARY KEY,
    Name  VARCHAR(100)  NOT NULL,
    Gender VARCHAR(20) NULL,
    DateOfBirth   DATE              NULL,
    Qualification  VARCHAR(100)      NULL,
    Department    VARCHAR(100)      NULL,
    Email    VARCHAR(150)      NOT NULL UNIQUE,
    PhoneNumber    VARCHAR(20)       NULL,
    Password     VARCHAR(255)      NOT NULL,
    Role    VARCHAR(50)       NOT NULL,
    Image VARBINARY(MAX),  
);

CREATE TABLE SECTION(
    ID INT PRIMARY KEY IDENTITY(1,1),
    NAME VARCHAR(7), 
    DEPARTMENT VARCHAR(2),
)

CREATE TABLE DEPARTMENT(
    ID INT PRIMARY KEY IDENTITY(1,1),
    NAME VARCHAR(2)
)

CREATE TABLE Student (
    StudentID INT PRIMARY KEY IDENTITY(1,1),
    userID INT FOREIGN KEY REFERENCES USERS (ID),
    Name VARCHAR(100) NOT NULL,
    DOB DATE,
    DEPARTMENT INT FOREIGN KEY REFERENCES DEPARTMENT(ID),
    CGPA FLOAT,
    Section INT FOREIGN KEY REFERENCES SECTION(ID),
    Intake VARCHAR(20),   -- e.g., 'Spring'
    YEAR INT -- 2025
);
-- SPRING2025
-- SPRING-2025
-- SPRING 2025



CREATE TABLE TEACHER(
    ID INT PRIMARY KEY IDENTITY(1,1),
    userID INT FOREIGN KEY REFERENCES USERS(ID),
    DESIGNATION VARCHAR(30)  NOT NULL,
    EXPERIENCE_IN_YEARS INT,
    DEPARTMENT VARCHAR(30)
);

CREATE TABLE COURSE(
    ID  INT IDENTITY(1,1) PRIMARY KEY,
    TITLE VARCHAR(50)  NOT NULL,
    COURSE_CODE VARCHAR(9)  NOT NULL,
    CATEGORY VARCHAR(20) NOT NULL,
    CREDIT_HRS INT NOT NULL
);

CREATE TABLE CourseOffering (
    ID INT PRIMARY KEY IDENTITY(1,1),
    CourseID INT NOT NULL FOREIGN KEY REFERENCES COURSE(ID),
    Semester INT NOT NULL,  
    DEPARTMENT INT FOREIGN KEY REFERENCES DEPARTMENT (ID), 
    Year INT NOT NULL
);


CREATE TABLE CourseAllocation (
    ID INT PRIMARY KEY IDENTITY(1,1),
    TeacherID INT NOT NULL FOREIGN KEY REFERENCES TEACHER(ID),
    OfferingID INT NOT NULL FOREIGN KEY REFERENCES CourseOffering(ID),
    SECTION INT FOREIGN KEY REFERENCES SECTION(ID),
    AllocationDate DATE DEFAULT GETDATE()
);

CREATE TABLE CourseEnrollment (
    ID INT PRIMARY KEY IDENTITY(1,1),
    StudentID INT NOT NULL FOREIGN KEY REFERENCES Student(StudentID),
    OfferingID INT NOT NULL FOREIGN KEY REFERENCES CourseOffering(ID),
    EnrollmentDate DATE DEFAULT GETDATE(),
    Status VARCHAR(20) DEFAULT 'Enrolled', -- 'Enrolled', 'Dropped', 'Completed'
    UNIQUE(StudentID, OfferingID)          -- prevent duplicate enrollment
);

CREATE TABLE EXAM(
    ID  INT IDENTITY(1,1) PRIMARY KEY,
    A_ID INT FOREIGN KEY REFERENCES CourseAllocation(ID),
    TITLE VARCHAR(50)  NOT NULL,
    TOTAL_QUESTIONS INT,
    E_DATE DATE,
    START_TIME VARCHAR(10),
    END_TIME VARCHAR(10),
    E_TYPE VARCHAR(6)
  );

 CREATE TABLE EXAM_DESC_QUES(
  ID  INT IDENTITY(1,1) PRIMARY KEY ,
  E_ID INT FOREIGN KEY REFERENCES EXAM (ID),
  DESCRIPTION VARCHAR(MAX),
  MARKS INT 
  );

  CREATE TABLE EXAM_MCQ(
  ID  INT IDENTITY(1,1) PRIMARY KEY ,
  E_ID INT FOREIGN KEY REFERENCES EXAM (ID),
  DESCRIPTION VARCHAR(MAX),
  MARKS INT 
  );

  CREATE TABLE MCQ_OPTION(
   ID INT IDENTITY(1,1) PRIMARY KEY ,
   Q_ID  INT FOREIGN KEY REFERENCES EXAM_MCQ(ID),
   OP1 VARCHAR(20) NOT NULL,
    OP2 VARCHAR(20) NOT NULL,
    OP3 VARCHAR(20) NOT NULL,
    OP4 VARCHAR(20) NOT NULL,
   CORRECT_OP VARCHAR(20) NOT NULL
  );

  CREATE TABLE DES_ANS(
  ID INT IDENTITY(1,1) PRIMARY KEY ,
  Q_ID INT FOREIGN KEY REFERENCES EXAM_DESC_QUES(ID),
  S_ID INT FOREIGN KEY REFERENCES STUDENT (StudentID),
  ANSWERS VARCHAR(MAX)
  );


  CREATE TABLE MCQ_ANS(
    ID INT IDENTITY(1,1) PRIMARY KEY ,
    Q_ID INT FOREIGN KEY REFERENCES EXAM_DESC_QUES(ID),
    S_ID INT FOREIGN KEY REFERENCES STUDENT (StudentID),
    CORRECT_OP VARCHAR(20)
  );



-- ====================
-- DEPARTMENTS
-- ====================
INSERT INTO DEPARTMENT (NAME)
VALUES ('CS'), ('SE'), ('AI');

-- ====================
-- SECTIONS (A-D per department)
-- ====================
INSERT INTO SECTION (NAME, DEPARTMENT)
VALUES 
('A', 'CS'), ('B', 'CS'), ('C', 'CS'), ('D', 'CS'),
('A', 'SE'), ('B', 'SE'), ('C', 'SE'), ('D', 'SE'),
('A', 'AI'), ('B', 'AI'), ('C', 'AI'), ('D', 'AI');

-- ====================
-- USERS
-- ====================
INSERT INTO USERS (Name, Gender, DateOfBirth, Qualification, Department, Email, PhoneNumber, Password, Role)
VALUES 
('Ali Khan', 'Male', '1999-05-12', 'BS CS', 'CS', 'ali.khan@gmail.com', '03001234567', 'password123', 'Student'),
('Sara Ahmed', 'Female', '2000-08-22', 'BS CS', 'CS', 'sara.ahmed@gmail.com', '03007654321', 'password123', 'Student'),
('Ahmed Raza', 'Male', '1998-11-05', 'BS SE', 'SE', 'ahmed.raza@gmail.com', '03004567890', 'password123', 'Student'),
('Fatima Noor', 'Female', '2001-02-14', 'BS AI', 'AI', 'fatima.noor@gmail.com', '03007894561', 'password123', 'Student'),
('Hassan Ali', 'Male', '1997-09-30', 'BS CS', 'CS', 'hassan.ali@gmail.com', '03005678912', 'password123', 'Student'),
('Dr. Hassan', 'Male', '1980-01-15', 'PhD CS', 'CS', 'hassan@gmail.com', '03001239876', 'password123', 'Teacher'),
('Mr. Aftab', 'Male', '1985-02-20', 'MS SE', 'SE', 'aftab@gmail.com', '03005678901', 'password123', 'Teacher'),
('Mr. Shahid Jamil', 'Male', '1982-11-10', 'MS AI', 'AI', 'shahid@gmail.com', '03009876543', 'password123', 'Teacher'),
('Zainab Khan', 'Female', '1999-07-25', 'BS CS', 'CS', 'zainab.khan@gmail.com', '03006543210', 'password123', 'Student'),
('Hira Ali', 'Female', '2000-03-18', 'BS AI', 'AI', 'hira.ali@gmail.com', '03003456789', 'password123', 'Student');

-- ====================
-- STUDENTS
-- ====================
INSERT INTO Student (userID, Name, DOB, DEPARTMENT, CGPA, Section, Intake, YEAR)
VALUES
(1, 'Ali Khan', '1999-05-12', 1, 3.5, 1, 'Spring2025', 2025),
(2, 'Sara Ahmed', '2000-08-22', 1, 3.8, 2, 'Spring2025', 2025),
(3, 'Ahmed Raza', '1998-11-05', 2, 3.2, 5, 'Spring2025', 2025),
(4, 'Fatima Noor', '2001-02-14', 3, 3.7, 9, 'Spring2025', 2025),
(5, 'Hassan Ali', '1997-09-30', 1, 3.9, 3, 'Spring2025', 2025),
(9, 'Zainab Khan', '1999-07-25', 1, 3.6, 4, 'Spring2025', 2025),
(10, 'Hira Ali', '2000-03-18', 3, 3.4, 10, 'Spring2025', 2025);

-- ====================
-- TEACHERS
-- ====================
INSERT INTO TEACHER (userID, DESIGNATION, EXPERIENCE_IN_YEARS, DEPARTMENT)
VALUES
(6, 'Professor', 15, 'CS'),
(7, 'Assistant Professor', 10, 'SE'),
(8, 'Lecturer', 12, 'AI');

-- ====================
-- COURSES
-- ====================
INSERT INTO COURSE (TITLE, COURSE_CODE, CATEGORY, CREDIT_HRS)
VALUES
('Natural Language Processing', 'AI501', 'Core', 3),
('Computer Vision', 'CS502', 'Core', 3),
('Machine Learning', 'AI503', 'Core', 3),
('Data Structures', 'CS101', 'Core', 3),
('Algorithms', 'CS102', 'Core', 3),
('Database Systems', 'CS201', 'Core', 3),
('Software Engineering', 'SE202', 'Core', 3),
('Networking', 'CS301', 'Core', 3),
('AI Ethics', 'AI601', 'Elective', 3),
('Deep Learning', 'AI504', 'Core', 3),
('Operating Systems', 'CS203', 'Core', 3);

-- ====================
-- COURSE OFFERING
-- ====================
INSERT INTO CourseOffering (CourseID, Semester, DEPARTMENT, Year)
VALUES
(1, 5, 3, 2025),
(2, 5, 1, 2025),
(3, 5, 3, 2025),
(4, 3, 1, 2025),
(5, 3, 1, 2025),
(6, 4, 1, 2025),
(7, 4, 2, 2025),
(8, 6, 1, 2025),
(9, 6, 3, 2025),
(10, 5, 3, 2025),
(11, 4, 1, 2025);

-- ====================
-- COURSE ALLOCATION
-- ====================
INSERT INTO CourseAllocation (TeacherID, OfferingID, SECTION)
VALUES
(1, 1, 1),
(2, 2, 5),
(3, 3, 9),
(1, 4, 2),
(2, 5, 6),
(3, 6, 10),
(1, 7, 3),
(2, 8, 7),
(3, 9, 11),
(1, 10, 4),
(2, 11, 8);

-- ====================
-- COURSE ENROLLMENT
-- ====================
INSERT INTO CourseEnrollment (StudentID, OfferingID)
VALUES
(1,1),(1,2),(1,3),
(2,1),(2,3),(2,5),
(3,2),(3,4),(3,6),
(4,3),(4,5),(4,7),
(5,1),(5,2),(5,3),
(6,1),(6,2),(6,3),
(7,1),(7,4),(7,5);


INSERT INTO EXAM (A_ID, TITLE, TOTAL_QUESTIONS, E_DATE, START_TIME, END_TIME, E_TYPE)
VALUES
(1, 'Midterm NLP', 5, '2025-06-15', '10:00', '11:00', 'MCQ'),
(2, 'Final CV', 6, '2025-07-20', '09:00', '10:30', 'DES'),
(3, 'Midterm ML', 4, '2025-06-18', '11:00', '12:00', 'MCQ'),
(4, 'Final Data Structures', 5, '2025-07-22', '14:00', '15:30', 'MIX'),
(5, 'Midterm Algorithms', 5, '2025-06-20', '13:00', '14:00', 'MCQ');
INSERT INTO EXAM_DESC_QUES (E_ID, DESCRIPTION, MARKS)
VALUES
(2, 'Explain the concept of convolution in CV.', 10),
(2, 'Describe different image preprocessing techniques.', 10),
(4, 'Explain stack and queue implementation in C.', 5),
(4, 'Write an algorithm for binary search.', 5),
(4, 'Explain complexity analysis of sorting algorithms.', 5);
INSERT INTO EXAM_MCQ (E_ID, DESCRIPTION, MARKS)
VALUES
(1, 'Which language model is GPT-3 based on?', 2),
(1, 'What is tokenization in NLP?', 2),
(3, 'Which algorithm is used for supervised learning?', 2),
(3, 'Which activation function is commonly used in neural networks?', 2),
(5, 'What is the time complexity of quicksort in average case?', 2);
INSERT INTO MCQ_OPTION (Q_ID, OP1, OP2, OP3, OP4, CORRECT_OP)
VALUES
(1, 'RNN', 'Transformer', 'CNN', 'SVM', 'OP2'),
(2, 'Splitting text', 'Parsing JSON', 'Token Encryption', 'Vectorization', 'OP1'),
(3, 'K-Means', 'Linear Regression', 'DBSCAN', 'PCA', 'OP2'),
(4, 'ReLU', 'Sigmoid', 'Tanh', 'Softmax', 'OP1'),
(5, 'O(n^2)', 'O(n log n)', 'O(n)', 'O(log n)', 'OP2');


INSERT INTO DES_ANS (Q_ID, S_ID, ANSWERS)
VALUES
(1, 1, 'Transformer model uses attention mechanism for NLP tasks.'),
(2, 2, 'Tokenization is splitting text into words or subwords.'),
(3, 3, 'Stack is LIFO; Queue is FIFO; implemented using arrays.'),
(4, 4, 'Binary search divides array in half recursively until found.'),
(5, 5, 'Sorting complexity depends on pivot selection in quicksort.');
INSERT INTO MCQ_ANS (Q_ID, S_ID, CORRECT_OP)
VALUES
(1, 1, 'OP2'),
(2, 2, 'OP1'),
(3, 3, 'OP2'),
(4, 4, 'OP1'),
(5, 5, 'OP2');


SELECT * FROM MCQ_ANS
SELECT S.NAME, EX.TITLE, C.TITLE, EM.DESCRIPTION, MA.CORRECT_OP, MOP.CORRECT_OP FROM STUDENT S 
JOIN MCQ_ANS MA ON MA.S_ID = S.STUDENTID 
JOIN EXAM_MCQ EM ON EM.ID = MA.Q_ID
JOIN EXAM EX ON EX.ID = EM.E_ID
JOIN MCQ_OPTION MOP ON MOP.Q_ID = MA.Q_ID
JOIN CourseAllocation CA ON CA.ID = EX.A_ID
JOIN CourseOffering CF ON CA.OfferingID = CF.ID
JOIN COURSE C ON C.ID = CF.CourseID
WHERE NAME = 'ALI KHAN'


 select std.Name, sec.NAME, sec.DEPARTMENT, c.TITLE from student std 
  JOIN Section sec on sec.id = std.section 
  JOIN CourseEnrollment en on en.StudentID = std.StudentID 
  JOIN CourseOffering cf on cf.ID = en.OfferingID 
  JOIN CourseAllocation ca on c
  JOIN course c on c.ID = cf.CourseID 

  where std.name = 'ali khan' 